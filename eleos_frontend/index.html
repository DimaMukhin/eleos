<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="shortcut icon" href="favicon.png">
	<meta charset="UTF-8">
	<title> Eleos </title>
	<link rel="stylesheet" type="text/css" href="style.css"/>	

</head>
<body>

	<div class="title">
	<h1>E L E O S</h1>
	<br><br><br>
	<center>
	<p>
	  💎 item:&nbsp&nbsp<input type="string" name="item" id="item"><br>
	  🏠 city:&nbsp&nbsp&nbsp<input type="string" name="location" id="location"><br>
	  📧 email:<input type="string" name="email" id="email"><br>
	  <button>find</button>
	</p>

	<br>
	<div id="results"> </div>

	</center>
	</div>

<!--<script src="js/jquery-3.3.1.min.js"></script>
 <script src="js/main.js"></script> -->

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


<script type="text/javascript"> 
$(document).ready(function(){
	$("button").click(function(){
		var item = $('#item').val();
		var location = $('#location').val();
		var email = $('#email').val();
		var html = '';

		fetch(`http://localhost:4000/api/free?city=${location}&item=${item}&email=${email}`)
			.then((res) => res.json())
			.then((data) => makeHTML(data, html));

		/*
		var array = 
		{
		    "listings": [
		        {"title":"Clean pull-out couch/sleeper sofa (Cornwall/lettered streets)", "url":"https://bellingham.craigslist.org/zip/d/clean-pull-out-couch-sleeper/6762395659.html"},
		        {"title":"Free couch/sofa", "url":"https://bellingham.craigslist.org/zip/d/free-couch-sofa/6762360073.html"},
		        {"title":"Couch and Loveseat (Blaine)", "url":"https://bellingham.craigslist.org/zip/d/couch-and-loveseat/6762307300.html"}
		    ]
		};
		*/
	});
});

function makeHTML(array, html) {

	console.log(array); 

	if (array === undefined || array.length == 0) {
    	html += '<p> will notify ' + $('#email').val() + ' asap!</p>';
	} else {
		for (var i in array) 
		{	
	    	var listing = array[i];

	    	html += '<p>';

	    	html += '<a href="' + listing.url + '" target="_blank"> ' + listing.title + ' </a>'; 

	    	html += '</p>';
		}
	}

	$("#results").html(html);
}

</script>	
</body>
</html>


